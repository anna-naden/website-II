// data is an array of objects 
// with two properties: date and number
// var data = [
// 	{ date: 2000, number: 23 },
// 	{ date: 2001, number: 25 },
// 	{ date: 2002, number: 28 },
// 	{ date: 2003, number: 30 },
// 	{ date: 2004, number: -31 },
// 	{ date: 2005, number: 35 },
// 	{ date: 2006, number: 38 },
// 	{ date: 2007, number: 42 },
// 	{ date: 2008, number: 45 },
// 	{ date: 2009, number: 51 },
// 	{ date: 2010, number: 54 },
// 	{ date: 2011, number: 56 },
// 	{ date: 2012, number: 57 },
// 	{ date: 2013, number: 60 },
// 	{ date: 2014, number: 61 },
// 	{ date: 2015, number: -62 },
// 	{ date: 2016, number: 64 },
// 	{ date: 2017, number: 67 },
// 	{ date: 2018, number: 69 },
// 	{ date: 2019, number: -75 },
// 	{ date: 2020, number: 78 },
// ];
var data = {"fips": 17031, "start_date": "04/11/20", "end_date": "10/11/20", "county": "Cook County, IL", "stats":[{"date":1586649600000,"deaths":9.4170496752},{"date":1586736000000,"deaths":10.5432123168},{"date":1586822400000,"deaths":11.2033766239},{"date":1586908800000,"deaths":12.2324562792},{"date":1586995200000,"deaths":14.0187832279},{"date":1587081600000,"deaths":14.7566139241},{"date":1587168000000,"deaths":16.6982736509},{"date":1587254400000,"deaths":17.0283558045},{"date":1587340800000,"deaths":17.7661865007},{"date":1587427200000,"deaths":19.455430463},{"date":1587513600000,"deaths":20.8145922718},{"date":1587600000000,"deaths":22.1737540806},{"date":1587686400000,"deaths":23.6882486676},{"date":1587772800000,"deaths":24.6008287392},{"date":1587859200000,"deaths":25.4939922136},{"date":1587945600000,"deaths":26.1541565207},{"date":1588032000000,"deaths":28.2899822202},{"date":1588118400000,"deaths":29.4355614591},{"date":1588204800000,"deaths":31.2024718105},{"date":1588291200000,"deaths":32.4839672302},{"date":1588377600000,"deaths":33.843129039},{"date":1588464000000,"deaths":34.6780427216},{"date":1588550400000,"deaths":34.9887082779},{"date":1588636800000,"deaths":37.3186999501},{"date":1588723200000,"deaths":38.9108609261},{"date":1588809600000,"deaths":40.9690202366},{"date":1588896000000,"deaths":42.6582641989},{"date":1588982400000,"deaths":43.9591762159},{"date":1589068800000,"deaths":44.9882558711},{"date":1589155200000,"deaths":45.842586151},{"date":1589241600000,"deaths":47.5512467106},{"date":1589328000000,"deaths":50.2695703282},{"date":1589414400000,"deaths":51.9393976933},{"date":1589500800000,"deaths":53.6286416556},{"date":1589587200000,"deaths":54.6383047136},{"date":1589673600000,"deaths":55.1237196453},{"date":1589760000000,"deaths":56.0945495087},{"date":1589846400000,"deaths":57.8614598602},{"date":1589932800000,"deaths":59.6866200034},{"date":1590019200000,"deaths":60.4632838941},{"date":1590105600000,"deaths":61.8806954947},{"date":1590192000000,"deaths":63.0262747336},{"date":1590278400000,"deaths":64.1524373752},{"date":1590364800000,"deaths":64.5407693205},{"date":1590451200000,"deaths":65.1232672386},{"date":1590537600000,"deaths":67.0843435627},{"date":1590624000000,"deaths":68.3270057879},{"date":1590710400000,"deaths":69.3172522486},{"date":1590796800000,"deaths":69.9579999584},{"date":1590883200000,"deaths":70.7152472519},{"date":1590969600000,"deaths":71.0259128082},{"date":1591056000000,"deaths":72.3462414225},{"date":1591142400000,"deaths":73.394737675},{"date":1591228800000,"deaths":74.6762330947},{"date":1591315200000,"deaths":75.3363974018},{"date":1591401600000,"deaths":75.9771451117},{"date":1591488000000,"deaths":76.579059627},{"date":1591574400000,"deaths":76.870308586},{"date":1591660800000,"deaths":77.8605550467},{"date":1591747200000,"deaths":78.6954687293},{"date":1591833600000,"deaths":79.8216313709},{"date":1591920000000,"deaths":80.8118778315},{"date":1592006400000,"deaths":81.0254604015},{"date":1592092800000,"deaths":81.3361259578},{"date":1592179200000,"deaths":81.6662081114},{"date":1592265600000,"deaths":82.578788183},{"date":1592352000000,"deaths":83.5690346437},{"date":1592438400000,"deaths":84.1321159645},{"date":1592524800000,"deaths":84.7146138825},{"date":1592611200000,"deaths":85.2388620088},{"date":1592697600000,"deaths":85.5106943705},{"date":1592784000000,"deaths":85.8796097186},{"date":1592870400000,"deaths":86.1902752749},{"date":1592956800000,"deaths":86.9475225684},{"date":1593043200000,"deaths":87.3746877083},{"date":1593129600000,"deaths":87.8795192373},{"date":1593216000000,"deaths":88.07368521},{"date":1593302400000,"deaths":88.1901847936},{"date":1593388800000,"deaths":88.4231839608},{"date":1593475200000,"deaths":88.6367665308},{"date":1593561600000,"deaths":88.9474320871},{"date":1593648000000,"deaths":89.4910968106},{"date":1593734400000,"deaths":89.665846186},{"date":1593820800000,"deaths":89.7435125751},{"date":1593907200000,"deaths":89.8405955614},{"date":1593993600000,"deaths":89.8988453532},{"date":1594080000000,"deaths":90.3065938958},{"date":1594166400000,"deaths":90.5590096603},{"date":1594252800000,"deaths":90.7920088276},{"date":1594339200000,"deaths":91.1220909811},{"date":1594425600000,"deaths":91.471589732},{"date":1594512000000,"deaths":91.7434220937},{"date":1594598400000,"deaths":91.8210884828},{"date":1594684800000,"deaths":92.05408765},{"date":1594771200000,"deaths":92.1317540391},{"date":1594857600000,"deaths":92.2288370254},{"date":1594944000000,"deaths":92.5200859845},{"date":1595030400000,"deaths":92.6948353599},{"date":1595116800000,"deaths":92.7336685544},{"date":1595203200000,"deaths":92.7530851517},{"date":1595289600000,"deaths":92.9666677216},{"date":1595376000000,"deaths":93.2190834861},{"date":1595462400000,"deaths":93.3938328615},{"date":1595548800000,"deaths":93.6268320288},{"date":1595635200000,"deaths":93.7627482096},{"date":1595721600000,"deaths":93.7821648069},{"date":1595808000000,"deaths":94.0151639741},{"date":1595894400000,"deaths":94.3064129332},{"date":1595980800000,"deaths":94.442329114},{"date":1596067200000,"deaths":94.5976618922},{"date":1596153600000,"deaths":94.8694942539},{"date":1596240000000,"deaths":94.9083274485},{"date":1596326400000,"deaths":95.0248270321},{"date":1596412800000,"deaths":95.0830768239},{"date":1596499200000,"deaths":95.1801598102},{"date":1596585600000,"deaths":95.3160759911},{"date":1596672000000,"deaths":95.3743257829},{"date":1596758400000,"deaths":95.5296585611},{"date":1596844800000,"deaths":95.6073249502},{"date":1596931200000,"deaths":95.6849913392},{"date":1597017600000,"deaths":95.6849913392},{"date":1597104000000,"deaths":95.7820743256},{"date":1597190400000,"deaths":95.8014909228},{"date":1597276800000,"deaths":95.9762402983},{"date":1597363200000,"deaths":96.1315730764},{"date":1597449600000,"deaths":96.1704062709},{"date":1597536000000,"deaths":96.3451556464},{"date":1597622400000,"deaths":96.3839888409},{"date":1597708800000,"deaths":96.5781548136},{"date":1597795200000,"deaths":96.7723207863},{"date":1597881600000,"deaths":96.8499871753},{"date":1597968000000,"deaths":97.0247365508},{"date":1598054400000,"deaths":97.2383191207},{"date":1598140800000,"deaths":97.3354021071},{"date":1598227200000,"deaths":97.3742353016},{"date":1598313600000,"deaths":97.5101514825},{"date":1598400000000,"deaths":97.6849008579},{"date":1598486400000,"deaths":97.840233636},{"date":1598572800000,"deaths":97.9567332196},{"date":1598659200000,"deaths":97.9761498169},{"date":1598745600000,"deaths":98.1314825951},{"date":1598832000000,"deaths":98.2091489841},{"date":1598918400000,"deaths":98.345065165},{"date":1599004800000,"deaths":98.5003979432},{"date":1599091200000,"deaths":98.636314124},{"date":1599177600000,"deaths":98.7528137077},{"date":1599264000000,"deaths":98.8693132913},{"date":1599350400000,"deaths":98.9081464858},{"date":1599436800000,"deaths":98.9663962776},{"date":1599523200000,"deaths":98.9858128749},{"date":1599609600000,"deaths":99.0246460694},{"date":1599696000000,"deaths":99.0828958612},{"date":1599782400000,"deaths":99.2576452366},{"date":1599868800000,"deaths":99.5683107929},{"date":1599955200000,"deaths":99.6653937793},{"date":1600041600000,"deaths":99.6848103765},{"date":1600128000000,"deaths":99.7430601683},{"date":1600214400000,"deaths":99.9178095438},{"date":1600300800000,"deaths":99.937226141},{"date":1600387200000,"deaths":99.9954759328},{"date":1600473600000,"deaths":100.1313921137},{"date":1600560000000,"deaths":100.2284751001},{"date":1600646400000,"deaths":100.3255580864},{"date":1600732800000,"deaths":100.4226410727},{"date":1600819200000,"deaths":100.5779738509},{"date":1600905600000,"deaths":100.7138900318},{"date":1600992000000,"deaths":100.8498062127},{"date":1601078400000,"deaths":101.0245555881},{"date":1601164800000,"deaths":101.1604717689},{"date":1601251200000,"deaths":101.2963879498},{"date":1601337600000,"deaths":101.3740543389},{"date":1601424000000,"deaths":101.451720728},{"date":1601510400000,"deaths":101.529387117},{"date":1601596800000,"deaths":101.7235530897},{"date":1601683200000,"deaths":101.8400526733},{"date":1601769600000,"deaths":102.0536352433},{"date":1601856000000,"deaths":102.1313016324},{"date":1601942400000,"deaths":102.2866344105},{"date":1602028800000,"deaths":102.3837173969},{"date":1602115200000,"deaths":102.5002169805},{"date":1602201600000,"deaths":102.6943829532},{"date":1602288000000,"deaths":102.8691323286},{"date":1602374400000,"deaths":102.9079655231}]}

var us_data = {"start_date": "04/11/20", "end_date": "10/11/20", "stats":[{"date":1586649600000,"deaths":8.3517122377},{"date":1586736000000,"deaths":8.9449397086},{"date":1586822400000,"deaths":9.6948918777},{"date":1586908800000,"deaths":10.4925961033},{"date":1586995200000,"deaths":11.1586760707},{"date":1587081600000,"deaths":11.7981250835},{"date":1587168000000,"deaths":12.3974746129},{"date":1587254400000,"deaths":12.9882532604},{"date":1587340800000,"deaths":13.6564759482},{"date":1587427200000,"deaths":14.4358139983},{"date":1587513600000,"deaths":15.179338006},{"date":1587600000000,"deaths":15.933881719},{"date":1587686400000,"deaths":16.592921319},{"date":1587772800000,"deaths":17.111459676},{"date":1587859200000,"deaths":17.517658259},{"date":1587945600000,"deaths":17.9648746341},{"date":1588032000000,"deaths":18.6502390858},{"date":1588118400000,"deaths":19.4210062539},{"date":1588204800000,"deaths":20.1311650426},{"date":1588291200000,"deaths":20.710005676},{"date":1588377600000,"deaths":21.2279318271},{"date":1588464000000,"deaths":21.5707671044},{"date":1588550400000,"deaths":21.9778839962},{"date":1588636800000,"deaths":22.6862061674},{"date":1588723200000,"deaths":23.4098334849},{"date":1588809600000,"deaths":24.0009182353},{"date":1588896000000,"deaths":24.5356800473},{"date":1588982400000,"deaths":24.9911612015},{"date":1589068800000,"deaths":25.2642050116},{"date":1589155200000,"deaths":25.57367507},{"date":1589241600000,"deaths":26.071092325},{"date":1589328000000,"deaths":26.6107517839},{"date":1589414400000,"deaths":27.1562271983},{"date":1589500800000,"deaths":27.6701740113},{"date":1589587200000,"deaths":28.0427012725},{"date":1589673600000,"deaths":28.2741150847},{"date":1589760000000,"deaths":28.6325616112},{"date":1589846400000,"deaths":29.106102838},{"date":1589932800000,"deaths":29.5726036975},{"date":1590019200000,"deaths":29.9448248557},{"date":1590105600000,"deaths":30.32500469},{"date":1590192000000,"deaths":30.6638606293},{"date":1590278400000,"deaths":30.8536444435},{"date":1590364800000,"deaths":31.0207766412},{"date":1590451200000,"deaths":31.2234167783},{"date":1590537600000,"deaths":31.689305432},{"date":1590624000000,"deaths":32.0477519585},{"date":1590710400000,"deaths":32.40252525},{"date":1590796800000,"deaths":32.6957718532},{"date":1590883200000,"deaths":32.8736176533},{"date":1590969600000,"deaths":33.1111535241},{"date":1591056000000,"deaths":33.4374592434},{"date":1591142400000,"deaths":33.74570489},{"date":1591228800000,"deaths":34.0588481835},{"date":1591315200000,"deaths":34.3392384639},{"date":1591401600000,"deaths":34.5406541893},{"date":1591488000000,"deaths":34.6747272709},{"date":1591574400000,"deaths":34.8335946896},{"date":1591660800000,"deaths":35.1240863666},{"date":1591747200000,"deaths":35.399885103},{"date":1591833600000,"deaths":35.665582443},{"date":1591920000000,"deaths":35.91842346},{"date":1592006400000,"deaths":36.1510616839},{"date":1592092800000,"deaths":36.2453413851},{"date":1592179200000,"deaths":36.3653337322},{"date":1592265600000,"deaths":36.6218479843},{"date":1592352000000,"deaths":36.8489763555},{"date":1592438400000,"deaths":37.0684521536},{"date":1592524800000,"deaths":37.2735411141},{"date":1592611200000,"deaths":37.4584272816},{"date":1592697600000,"deaths":37.5453605126},{"date":1592784000000,"deaths":37.6641284479},{"date":1592870400000,"deaths":37.9230915235},{"date":1592956800000,"deaths":38.1554236444},{"date":1593043200000,"deaths":38.3237802538},{"date":1593129600000,"deaths":38.5123396564},{"date":1593216000000,"deaths":38.6666155312},{"date":1593302400000,"deaths":38.75018163},{"date":1593388800000,"deaths":38.8655824332},{"date":1593475200000,"deaths":39.0562845562},{"date":1593561600000,"deaths":39.2687199869},{"date":1593648000000,"deaths":39.4909507113},{"date":1593734400000,"deaths":39.6923664368},{"date":1593820800000,"deaths":39.7734837122},{"date":1593907200000,"deaths":39.861335252},{"date":1593993600000,"deaths":39.9700017908},{"date":1594080000000,"deaths":40.3440595666},{"date":1594166400000,"deaths":40.6079202889},{"date":1594252800000,"deaths":40.914635421},{"date":1594339200000,"deaths":41.1662520263},{"date":1594425600000,"deaths":41.3768508395},{"date":1594512000000,"deaths":41.5167398767},{"date":1594598400000,"deaths":41.6287735477},{"date":1594684800000,"deaths":41.9106943427},{"date":1594771200000,"deaths":42.2063897694},{"date":1594857600000,"deaths":42.4947387259},{"date":1594944000000,"deaths":42.7791083443},{"date":1595030400000,"deaths":43.0432751696},{"date":1595116800000,"deaths":43.1801031776},{"date":1595203200000,"deaths":43.3371339787},{"date":1595289600000,"deaths":43.6744594033},{"date":1595376000000,"deaths":44.0457622528},{"date":1595462400000,"deaths":44.3803327511},{"date":1595548800000,"deaths":44.7265351606},{"date":1595635200000,"deaths":45.0011094854},{"date":1595721600000,"deaths":45.1455900665},{"date":1595808000000,"deaths":45.487813138},{"date":1595894400000,"deaths":45.9080924556},{"date":1595980800000,"deaths":46.3452074342},{"date":1596067200000,"deaths":46.7146736661},{"date":1596153600000,"deaths":47.0942412945},{"date":1596240000000,"deaths":47.4349338514},{"date":1596326400000,"deaths":47.5582933306},{"date":1596412800000,"deaths":47.7202217785},{"date":1596499200000,"deaths":48.1417255079},{"date":1596585600000,"deaths":48.5620048255},{"date":1596672000000,"deaths":48.9452456891},{"date":1596758400000,"deaths":49.3245072146},{"date":1596844800000,"deaths":49.6541800661},{"date":1596931200000,"deaths":49.8096803526},{"date":1597017600000,"deaths":49.9703843888},{"date":1597104000000,"deaths":50.2957717994},{"date":1597190400000,"deaths":50.7561506003},{"date":1597276800000,"deaths":51.0836807313},{"date":1597363200000,"deaths":51.4932464465},{"date":1597449600000,"deaths":51.8094507693},{"date":1597536000000,"deaths":51.9839294372},{"date":1597622400000,"deaths":52.1207574452},{"date":1597708800000,"deaths":52.5257316165},{"date":1597795200000,"deaths":52.9389705669},{"date":1597881600000,"deaths":53.2692556242},{"date":1597968000000,"deaths":53.6074993576},{"date":1598054400000,"deaths":53.908398534},{"date":1598140800000,"deaths":54.045532645},{"date":1598227200000,"deaths":54.1805240354},{"date":1598313600000,"deaths":54.5588672522},{"date":1598400000000,"deaths":54.9338433367},{"date":1598486400000,"deaths":55.2739236877},{"date":1598572800000,"deaths":55.5705374232},{"date":1598659200000,"deaths":55.8628657177},{"date":1598745600000,"deaths":55.9574515218},{"date":1598832000000,"deaths":56.1325423956},{"date":1598918400000,"deaths":56.4588481149},{"date":1599004800000,"deaths":56.781786702},{"date":1599091200000,"deaths":57.109622936},{"date":1599177600000,"deaths":57.4040939509},{"date":1599264000000,"deaths":57.6394871012},{"date":1599350400000,"deaths":57.7610099629},{"date":1599436800000,"deaths":57.8427394441},{"date":1599523200000,"deaths":57.9786491434},{"date":1599609600000,"deaths":58.3435238314},{"date":1599696000000,"deaths":58.6248324205},{"date":1599782400000,"deaths":58.99613527},{"date":1599868800000,"deaths":59.2146927592},{"date":1599955200000,"deaths":59.3303996653},{"date":1600041600000,"deaths":59.4586567914},{"date":1600128000000,"deaths":59.8523051545},{"date":1600214400000,"deaths":60.152898228},{"date":1600300800000,"deaths":60.4189016708},{"date":1600387200000,"deaths":60.7048018038},{"date":1600473600000,"deaths":60.9218287785},{"date":1600560000000,"deaths":60.9913141427},{"date":1600646400000,"deaths":61.0993684757},{"date":1600732800000,"deaths":61.3806770648},{"date":1600819200000,"deaths":61.7121865339},{"date":1600905600000,"deaths":61.9916585055},{"date":1600992000000,"deaths":62.2821501824},{"date":1601078400000,"deaths":62.5080541419},{"date":1601164800000,"deaths":62.5894775203},{"date":1601251200000,"deaths":62.686206045},{"date":1601337600000,"deaths":62.9656780166},{"date":1601424000000,"deaths":63.2549452818},{"date":1601510400000,"deaths":63.5175815924},{"date":1601596800000,"deaths":63.7903192997},{"date":1601683200000,"deaths":63.9984692895},{"date":1601769600000,"deaths":64.1010137697},{"date":1601856000000,"deaths":64.2415150128},{"date":1601942400000,"deaths":64.4560931641},{"date":1602028800000,"deaths":64.7355651357},{"date":1602115200000,"deaths":65.028505636},{"date":1602201600000,"deaths":65.3263437832},{"date":1602288000000,"deaths":65.5142909799},{"date":1602374400000,"deaths":65.6355077386}]}
title = "US and " + data.county + '\n fatalities per 100,000 persons in past six months:\n' +
	data.start_date + ' - ' + data.end_date
data = data.stats
us_data = us_data.stats

// Date Formats
// var time_parse  = d3.timeParse('%Y');  // Converting the year to the date object
// var time_format = d3.timeFormat('%Y'); //Converting the date object to the year

var barchart_width  = 800;
var barchart_height = 600;
var padding         = 40;


// The date format
data.forEach(function(e,i) {
	// data[i].date = time_parse(e.date);
	data[i].date = new Date(e.date);
});


// Creating scales
var x_scale = d3.scaleTime()
				.domain([
					d3.min(data, function(d) {
						return d.date;
					}),
					d3.max(data, function(d) {
						return d.date;
					})
				])
				.range([padding, barchart_width - padding]);

var y_scale = d3.scaleLinear()
				.domain([
					0, d3.max(data, function(d) {
						return d.deaths;
					})
				])
				.range([barchart_height - padding, padding]);


// Creating elements
var svg =  d3.select('#barchart')
			.append('svg')  
			.attr('height', barchart_height)
			.attr('width', barchart_width);

// Creating axis
// The x-axis
var x_axis = d3.axisBottom(x_scale)
			.ticks(5)
			// .tickFormat(time_format);

// The y-axis
var y_axis = d3.axisLeft(y_scale)
			   .ticks(8);

// Draw and position the axis
svg.append('g')
   .attr('transform', 'translate(0,'+ (barchart_height-padding) +')')
   .call(x_axis);

svg.append('g')
   .attr('class', 'y-axis')
   .attr('transform', 'translate(' + padding +',0)')
   .call(y_axis);

   svg.append("text")
   .attr("x", (barchart_width / 2))             
   .attr("y", padding / 2)
   .attr("text-anchor", "middle")  
   .style("font-size", "16px") 
   .style("text-decoration", "underline")  
   .text(title);

// Creating the line
var line1 = d3.line()
		.defined(function(d){
			return d.deaths >= 0;
		})
		.x(function(d){
			return x_scale(d.date);
		})
		.y(function(d){
			return y_scale(d.deaths);
		});

// Creating the line
var line2 = d3.line()
		.defined(function(d){
			return d.deaths >= 0;
		})
		.x(function(d){
			return x_scale(d.date);
		})
		.y(function(d){
			return y_scale(d.deaths);
		});

svg.append('path')
	.datum(data)
	.attr('fill', 'none')
	.attr('stroke', 'grey')
	.attr('stroke-width', 5)
    .attr('d', line1);
svg.append('path')
	.datum(us_data)
	.attr('fill', 'none')
	.attr('stroke', 'red')
	.attr('stroke-width', 5)
	.attr('d', line2);

// Legend
var legend = svg.append("g")
  .attr("class", "legend")
  .attr("x", barchart_width - 65)
  .attr("y", 25)
  .attr("height", 100)
  .attr("width", 100);

legend.selectAll('rect')
		.data(data)
		.enter()

legend.append("rect")
  .attr("x", barchart_width - 65)
  .attr("y", 25)
  .attr("width", 10)
  .attr("height", 10)
  .style("fill", function(d) { return "red" });

legend.append("text")
  .attr("x", barchart_width - 40)
  .attr("y", 35)
  .text(function(d) { return "US" });